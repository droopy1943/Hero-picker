<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Hero Queue Manager</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; background:#111; color:#fff; }
  select, button { margin: 5px; padding:5px 10px; font-size: 1rem; }
  button { background:#ffcc00; border:none; cursor:pointer; font-weight:bold; }
  button:hover { background:#ffaa00; }
  ul { list-style:none; padding-left:0; }
  li { margin:10px 0; padding:10px; background:#222; border-radius:6px; font-size:1.3rem; font-weight:bold; }
</style>
</head>
<body>
<h1>Hero Queue Manager</h1>

<label for="heroSelect">Add Hero to Queue:</label><br>
<select id="heroSelect">
  <option value="Adam Warlock">Adam Warlock</option>
  <option value="Angela">Angela</option>
  <option value="Black Panther">Black Panther</option>
  <option value="Black Widow">Black Widow</option>
  <option value="Blade">Blade</option>
  <option value="Captain America">Captain America</option>
  <option value="Cloak & Dagger">Cloak & Dagger</option>
  <option value="Doctor Strange">Doctor Strange</option>
  <option value="Emma Frost">Emma Frost</option>
  <option value="Groot">Groot</option>
  <option value="Hawkeye">Hawkeye</option>
  <option value="Hela">Hela</option>
  <option value="Hulk">Hulk</option>
  <option value="Human Torch">Human Torch</option>
  <option value="Invisible Woman">Invisible Woman</option>
  <option value="Iron Fist">Iron Fist</option>
  <option value="Iron Man">Iron Man</option>
  <option value="Jeff the Land Shark">Jeff the Land Shark</option>
  <option value="Loki">Loki</option>
  <option value="Luna Snow">Luna Snow</option>
  <option value="Magik">Magik</option>
  <option value="Magneto">Magneto</option>
  <option value="Mantis">Mantis</option>
  <option value="Mister Fantastic">Mister Fantastic</option>
  <option value="Moon Knight">Moon Knight</option>
  <option value="Namor">Namor</option>
  <option value="Peni Parker">Peni Parker</option>
  <option value="Phoenix">Phoenix</option>
  <option value="Psylocke">Psylocke</option>
  <option value="The Punisher">The Punisher</option>
  <option value="The Thing">The Thing</option>
  <option value="Rocket Raccoon">Rocket Raccoon</option>
  <option value="Scarlet Witch">Scarlet Witch</option>
  <option value="Squirrel Girl">Squirrel Girl</option>
  <option value="Spider-Man">Spider-Man</option>
  <option value="Star-Lord">Star-Lord</option>
  <option value="Storm">Storm</option>
  <option value="Thor">Thor</option>
  <option value="Ultron">Ultron</option>
  <option value="Venom">Venom</option>
  <option value="Winter Soldier">Winter Soldier</option>
  <option value="Wolverine">Wolverine</option>
</select>
<br>
<button onclick="addHero()">Add Hero</button>
<button onclick="nextHero()">Next Hero</button>
<button onclick="clearQueue()">Clear Queue</button>

<h2>Current Queue:</h2>
<ul id="queueList"></ul>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database.js"></script>
<script>
  // Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyASjfLh3w3UQHRy1wvmWwD5ZfaXWjVYTnE",
    authDomain: "marvel-rivals-overlay-7f867.firebaseapp.com",
    databaseURL: "https://marvel-rivals-overlay-7f867-default-rtdb.firebaseio.com",
    projectId: "marvel-rivals-overlay-7f867",
    storageBucket: "marvel-rivals-overlay-7f867.firebasestorage.app",
    messagingSenderId: "1078364810175",
    appId: "1:1078364810175:web:fac410007b70b65e348f0a"
  };

  // Init Firebase
  const app = firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  let queue = [];
  let overlayWindow = null;

  function openOverlay() {
    if(!overlayWindow || overlayWindow.closed) {
      overlayWindow = window.open("overlay.html", "Overlay", "width=800,height=600");
    }
  }

  function refreshQueue() {
    const list = document.getElementById("queueList");
    list.innerHTML = queue.map((q,i)=>`<li>${i+1}. ${q}</li>`).join("");
  }

  // Listen for new heroes in Firebase
  db.ref("queue").on("child_added", snapshot => {
    const data = snapshot.val();
    queue.push(data.hero);
    refreshQueue();
  });

  function addHero() {
    const hero = document.getElementById("heroSelect").value;
    db.ref("queue").push({
      hero: hero,
      timestamp: Date.now()
    });
  }

  function nextHero() {
    if(queue.length === 0) return alert("Queue is empty!");
    const next = queue.shift();
    refreshQueue();
    openOverlay();
    overlayWindow.postMessage({hero: next}, "*");

    // Remove from Firebase
    db.ref("queue").orderByChild("timestamp").limitToFirst(1).once("child_added", snap => {
      db.ref("queue/" + snap.key).remove();
    });
  }

  function clearQueue() {
    queue = [];
    refreshQueue();
    db.ref("queue").remove();
  }

  refreshQueue();
</script>
</body>
</html>
