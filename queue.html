<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Hero Queue Manager</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; }
  input { margin: 5px; width: 200px; }
  button { margin: 5px; }
</style>
</head>
<body>
<h1>Hero Queue Manager</h1>

<input id="heroName" placeholder="Hero name">
<input id="heroImage" placeholder="Image URL">
<button onclick="addHero()">Add Hero</button>
<button onclick="nextHero()">Next Hero</button>

<h2>Current Queue:</h2>
<ul id="queueList"></ul>

<script>
const repo = "YOUR_REPO_NAME";       // <-- put your repo name
const user = "YOUR_GITHUB_USERNAME"; // <-- put your GitHub username
const token = "YOUR_PERSONAL_ACCESS_TOKEN"; // <-- create a PAT with repo access
const path = "queue.json";            // JSON file

let currentSha = null; // needed to update GitHub file

// Fetch the current queue
async function getQueue() {
  const resp = await fetch(`https://api.github.com/repos/${user}/${repo}/contents/${path}`);
  const data = await resp.json();
  currentSha = data.sha;
  return JSON.parse(atob(data.content));
}

// Update queue.json on GitHub
async function saveQueue(queue) {
  await fetch(`https://api.github.com/repos/${user}/${repo}/contents/${path}`, {
    method: "PUT",
    headers: {
      "Authorization": `token ${token}`,
      "Content-Type": "application/json"
    },
    body: JSON.stringify({
      message: "Update queue",
      content: btoa(unescape(encodeURIComponent(JSON.stringify(queue, null, 2)))),
      sha: currentSha
    })
  });
  await refreshQueue();
}

// Refresh the visible list
async function refreshQueue() {
  const queue = await getQueue();
  const list = document.getElementById("queueList");
  list.innerHTML = "";
  queue.forEach((q, i) => {
    const li = document.createElement("li");
    li.textContent = `${i+1}. ${q.name}`;
    list.appendChild(li);
  });
}

// Add a hero
async function addHero() {
  const name = document.getElementById("heroName").value.trim();
  const image = document.getElementById("heroImage").value.trim();
  if (!name || !image) return alert("Both fields required!");

  const queue = await getQueue();
  queue.push({ name, image });
  await saveQueue(queue);

  document.getElementById("heroName").value = "";
  document.getElementById("heroImage").value = "";
}

// Move to next hero
async function nextHero() {
  const queue = await getQueue();
  if (queue.length === 0) return alert("Queue is empty!");
  queue.shift();
  await saveQueue(queue);
}

// Initial load
refreshQueue();
</script>
</body>
</html>
