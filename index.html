<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Marvel Rivals Hero Picker</title>
<style>
  body {
    margin: 0;
    font-family: "Comic Sans MS", sans-serif;
    background: #0d0d0d;
    color: #fff;
    text-align: center;
  }

  h1 {
    margin-top: 20px;
    font-size: 2em;
    color: #f0f0f0;
  }

  .setup-card {
    background: #1c1c1c;
    border: 2px solid #333;
    border-radius: 10px;
    margin: 20px auto;
    padding: 20px;
    width: 90%;
    max-width: 500px;
    text-align: left;
    box-shadow: 0 0 10px #000;
  }

  .setup-card h2 {
    margin-top: 0;
    cursor: pointer;
  }

  .setup-fields label {
    display: block;
    margin-top: 10px;
  }

  .setup-fields input {
    width: 100%;
    padding: 6px;
    border-radius: 6px;
    border: none;
    margin-top: 4px;
  }

  .hint {
    font-size: 0.85em;
    color: #aaa;
  }

  button {
    background-color: #d32f2f;
    border: none;
    color: white;
    padding: 10px 20px;
    margin-top: 12px;
    border-radius: 6px;
    cursor: pointer;
    font-weight: bold;
  }

  button:hover {
    background-color: #b71c1c;
  }

  .toast {
    visibility: hidden;
    min-width: 200px;
    background-color: #333;
    color: #fff;
    text-align: center;
    border-radius: 6px;
    padding: 10px;
    position: fixed;
    z-index: 1;
    right: 20px;
    bottom: 30px;
    font-size: 16px;
    opacity: 0;
    transition: opacity 0.5s, visibility 0.5s;
  }

  .toast.show {
    visibility: visible;
    opacity: 1;
  }

  .hero-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
    gap: 15px;
    padding: 20px;
    margin: 0 auto;
    width: 90%;
    max-width: 900px;
  }

  .hero {
    position: relative;
    border: 2px solid #444;
    border-radius: 8px;
    overflow: hidden;
    transition: transform 0.2s, opacity 0.3s;
  }

  .hero img {
    width: 100%;
    height: auto;
    display: block;
  }

  .hero:hover {
    transform: scale(1.05);
  }

  .hero.disabled {
    opacity: 0.4;
    pointer-events: none;
  }

  .tooltip {
    position: absolute;
    bottom: 8px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0,0,0,0.75);
    color: #fff;
    font-size: 12px;
    padding: 4px 6px;
    border-radius: 4px;
    opacity: 0;
    transition: opacity 0.3s;
  }

  .hero.disabled:hover .tooltip {
    opacity: 1;
  }

  .notice {
    color: #ccc;
    font-size: 1.1em;
    margin-top: 50px;
  }
</style>
</head>

<body>
  <h1>Marvel Rivals Hero Picker</h1>

  <div class="setup-card" id="setupCard" style="display:none;">
    <h2>‚öôÔ∏è Streamer Setup ‚Äì Enter your Streamlabs Donation Page Username</h2>
    <div class="setup-fields">
      <label>Streamlabs Username:
        <input type="text" id="usernameInput" placeholder="e.g. droopy2">
        <div class="hint">üëâ Example: if your donation link is <code>https://streamlabs.com/droopy2/tip</code>, your username is <strong>droopy2</strong>.</div>
      </label>
      <label>Default Donation Amount ($):
        <input type="number" id="amountInput" placeholder="e.g. 5" min="1">
      </label>
      <label>Channel ID:
        <input type="text" id="channelInput" placeholder="e.g. Droopy">
      </label>
      <button onclick="saveSetup()">Save Setup</button>
      <button onclick="clearSetup()" style="background-color:#555;">Clear Setup</button>
    </div>
  </div>

  <div id="toast" class="toast">‚úÖ Setup saved!</div>
  <div id="viewerNotice" class="notice" style="display:none;">‚öôÔ∏è Streamer setup incomplete ‚Äî please wait until they finish setup.</div>

  <div class="hero-grid" id="heroGrid"></div>

  <script>
    const heroes = [
      "Adam Warlock","Angela","Black Panther","Black Widow","Blade","Captain America",
      "Cloak & Dagger","Doctor Strange","Emma Frost","Groot","Hawkeye","Hela","Hulk",
      "Human Torch","Invisible Woman","Iron Fist","Iron Man","Jeff the Land Shark","Loki",
      "Luna Snow","Magik","Magneto","Mantis","Mister Fantastic","Moon Knight","Namor",
      "Peni Parker","Phoenix","Psylocke","The Punisher","The Thing","Rocket Raccoon",
      "Scarlet Witch","Squirrel Girl","Spider-Man","Star-Lord","Storm","Thor","Ultron",
      "Venom","Winter Soldier","Wolverine"
    ];

    const heroGrid = document.getElementById("heroGrid");
    const toast = document.getElementById("toast");
    const setupCard = document.getElementById("setupCard");
    const viewerNotice = document.getElementById("viewerNotice");

    const params = new URLSearchParams(location.search);
    const isStreamerMode = params.get("view") === "streamer";

    function showToast(msg = "‚úÖ Setup saved!") {
      toast.textContent = msg;
      toast.classList.add("show");
      setTimeout(() => toast.classList.remove("show"), 3000);
    }

    function saveSetup() {
      const username = document.getElementById("usernameInput").value.trim();
      const amount = document.getElementById("amountInput").value.trim();
      const channel = document.getElementById("channelInput").value.trim();

      if (!username || !amount || !channel) {
        showToast("‚ö†Ô∏è Please complete all fields!");
        return;
      }

      localStorage.setItem("streamlabsUser", username);
      localStorage.setItem("defaultAmount", amount);
      localStorage.setItem("channelId", channel);

      showToast(`‚úÖ Setup saved for ${username} ‚Äì $${amount} tips`);
      renderHeroes();
    }

    function clearSetup() {
      localStorage.clear();
      showToast("üßπ Setup cleared!");
      renderHeroes();
    }

    function renderHeroes() {
      heroGrid.innerHTML = "";

      const username = localStorage.getItem("streamlabsUser");
      const amount = localStorage.getItem("defaultAmount");
      const channel = localStorage.getItem("channelId");
      const setupComplete = username && amount && channel;

      if (!setupComplete && !isStreamerMode) {
        viewerNotice.style.display = "block";
        return;
      } else {
        viewerNotice.style.display = "none";
      }

      heroes.forEach(hero => {
        const div = document.createElement("div");
        div.classList.add("hero");
        if (!setupComplete) div.classList.add("disabled");

        const img = document.createElement("img");
        img.src = `images/${hero}.png`;
        img.alt = hero;

        if (setupComplete) {
          const tipUrl = `https://streamlabs.com/${username}/tip?amount=${amount}&message=I%20want%20to%20request%20${encodeURIComponent(hero)}`;
          div.onclick = () => window.open(tipUrl, "_blank");
        } else if (isStreamerMode) {
          const tip = document.createElement("div");
          tip.classList.add("tooltip");
          tip.textContent = "Please complete setup first";
          div.appendChild(tip);
        }

        div.appendChild(img);
        heroGrid.appendChild(div);
      });
    }

    document.addEventListener("DOMContentLoaded", () => {
      const username = localStorage.getItem("streamlabsUser") || "";
      const amount = localStorage.getItem("defaultAmount") || "";
      const channel = localStorage.getItem("channelId") || "";

      if (isStreamerMode) {
        setupCard.style.display = "block";
        document.getElementById("usernameInput").value = username;
        document.getElementById("amountInput").value = amount;
        document.getElementById("channelInput").value = channel;
      }

      renderHeroes();
    });
  </script>
</body>
</html>
