<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Marvel Rivals Hero Overlay</title>
<style>
  body {
    margin: 0;
    background: rgba(0,0,0,0);
    overflow: hidden;
  }

  .overlay {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 100vh;
  }

  .char-wrapper {
    position: relative;
    display: inline-block;
    width: calc(400px * 1.05);
    height: calc(250px * 1.05);
    margin: 0 auto;
    overflow: visible;
  }

  #charImg {
    display: block;
    width: 100%;
    height: 100%;
    object-fit: contain;
    position: relative;
    z-index: 1;
  }

  #borderImg {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-52%, -52%) rotate(3deg);
    width: 135%;
    height: 138%;
    z-index: 2;
    pointer-events: none;
  }

  #donorText {
    position: absolute;
    bottom: -40px;
    left: 50%;
    transform: translateX(-50%);
    color: white;
    font-family: "Comic Sans MS", sans-serif;
    font-size: 22px;
    text-shadow: 2px 2px 4px #000;
    z-index: 3;
  }
</style>
</head>

<body>
  <div class="overlay">
    <div class="char-wrapper">
      <img id="charImg" alt="Hero Image">
      <img id="borderImg" src="images/comic_border.png" alt="Border Image">
      <div id="donorText"></div>
    </div>
  </div>

  <script>
    // Map hero names to image filenames
    const characters = {
      "Adam Warlock": "adamwarlock.png",
      "Angela": "angela.png",
      "Black Panther": "blackpanther.png",
      "Black Widow": "blackwidow.png",
      "Blade": "blade.png",
      "Captain America": "captainamerica.png",
      "Cloak & Dagger": "cloakanddagger.png",
      "Doctor Strange": "doctorstrange.png",
      "Emma Frost": "emmafrost.png",
      "Groot": "groot.png",
      "Hawkeye": "hawkeye.png",
      "Hela": "hela.png",
      "Hulk": "hulk.png",
      "Human Torch": "humantorch.png",
      "Invisible Woman": "invisiblewoman.png",
      "Iron Fist": "ironfist.png",
      "Iron Man": "ironman.png",
      "Jeff the Land Shark": "jeffthelandshark.png",
      "Loki": "loki.png",
      "Luna Snow": "lunasnow.png",
      "Magik": "magik.png",
      "Magneto": "magneto.png",
      "Mantis": "mantis.png",
      "Mister Fantastic": "misterfantastic.png",
      "Moon Knight": "moonknight.png",
      "Namor": "namor.png",
      "Peni Parker": "peniparker.png",
      "Phoenix": "phoenix.png",
      "Psylocke": "psylocke.png",
      "The Punisher": "thepunisher.png",
      "The Thing": "thething.png",
      "Rocket Raccoon": "rocketraccoon.png",
      "Scarlet Witch": "scarletwitch.png",
      "Squirrel Girl": "squirrelgirl.png",
      "Spider-Man": "spiderman.png",
      "Star-Lord": "starlord.png",
      "Storm": "storm.png",
      "Thor": "thor.png",
      "Ultron": "ultron.png",
      "Venom": "venom.png",
      "Winter Soldier": "wintersoldier.png",
      "Wolverine": "wolverine.png"
    };

    const charImgEl = document.getElementById("charImg");
    const donorTextEl = document.getElementById("donorText");

    function newDonation(heroName, donorName = "") {
  // find hero key (case-insensitive)
  const heroKey = Object.keys(characters).find(
    key => key.toLowerCase() === heroName.toLowerCase()
  );

  if (heroKey) {
    const fileName = characters[heroKey];
    charImgEl.src = `images/${fileName}`;
    charImgEl.style.display = "block";
    donorTextEl.textContent = donorName ? `Requested by ${donorName}` : "";
  } else {
    console.log("Hero not found:", heroName);
    charImgEl.style.display = "none";
    donorTextEl.textContent = "";
  }
}
    window.newDonation = newDonation;
  </script>

  <!-- Firebase listener -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-app.js";
    import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyASjfLh3w3UQHRy1wvmWwD5ZfaXWjVYTnE", // ⚠️ replace with your real "AIza..." key
      authDomain: "marvel-rivals-overlay-7f867.firebaseapp.com",
      databaseURL: "https://marvel-rivals-overlay-7f867-default-rtdb.firebaseio.com",
      projectId: "marvel-rivals-overlay-7f867",
      storageBucket: "marvel-rivals-overlay-7f867.appspot.com",
      messagingSenderId: "1078364810175",
      appId: "1:1078364810175:web:fac410007b70b65e348f0a"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    const params = new URLSearchParams(location.search);
    const channelId = params.get("channel") || "demo";

    const charImgEl = document.getElementById("charImg");
    const donorTextEl = document.getElementById("donorText");

    onValue(ref(db, `/channels/${channelId}/current`), (snap) => {
      const cur = snap.val();
      if (!cur || !cur.hero) return;

      console.log("Now showing:", cur.hero, "by", cur.donor || "Anonymous");
newDonation(cur.hero.trim(), cur.donor);

    });
  </script>
</body>
</html>
